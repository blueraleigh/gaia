% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/treeseq_sankoff.R
\name{treeseq_linear_mpr}
\alias{treeseq_linear_mpr}
\title{Compute linear parsimony costs for continuous geographic reconstruction}
\usage{
treeseq_linear_mpr(ts, sample_locations, use_brlen = FALSE, tol = 0.01)
}
\arguments{
\item{ts}{A \code{treeseq} object, typically loaded via \code{\link{treeseq_load}}}

\item{sample_locations}{A numeric matrix with columns:
\describe{
  \item{node_id}{Node identifiers for sampled genomes (0-based indexing)}
  \item{Additional columns}{Coordinate values for each spatial dimension (x, y, etc.)}
}}

\item{use_brlen}{Logical indicating whether to scale distances by inverse
branch lengths (TRUE) or treat all branches equally (FALSE, default)}

\item{tol}{Numeric tolerance for merging breakpoints in piecewise linear functions
(default: 0.01)}
}
\value{
A list with class \code{c("linear", "mpr")} containing:
  \describe{
    \item{mean_tree_length}{Genome-wide average absolute distance cost}
    \item{tree_length}{Vector giving the absolute distance cost for each local tree}
    \item{mpr}{Array containing piecewise linear function parameters for each node
      that define the absolute distance cost as a function of ancestor location}
  }
}
\description{
Uses linear parsimony to compute the minimum absolute distance costs needed
to explain sampled geographic coordinates under different possible ancestral 
locations. For each ancestral node, calculates parameters of a piecewise linear 
function that gives the total absolute distance cost required to explain all 
sampled descendant locations when that ancestor is placed at any point in 
continuous space.
}
\details{
This function implements linear (Manhattan distance) parsimony reconstruction on
tree sequences following the approach of Csűrös (2008). For each non-sample node,
it computes parameters of a piecewise linear function that gives the minimum total
absolute distance cost needed to explain the geographic coordinates of all sampled
descendants when that ancestor is placed at any location in continuous space.
These parameters are then used to determine optimal geographic locations using
\code{treeseq_linear_mpr_minimize}.

The method assumes ancestral locations can be anywhere in continuous space, rather
than restricted to discrete states like \code{treeseq_discrete_mpr}. It minimizes
the sum of absolute (L1) distances between connected nodes in the tree.
}
\examples{
# Load tree sequence
ts <- treeseq_load(system.file("extdata", "test.trees", package = "gaia"))

# Define the x and y coordinates (locations)
x <- c(0, 2, 1)
y <- c(0, 0, 1)

# Create the matrix using cbind() and ensuring integer type
samples <- cbind(node_id = 0:2, x = as.integer(x), y = as.integer(y))

# Compute absolute distance costs for nodes 0-6
mpr_costs <- treeseq_linear_mpr(ts, samples)

# Use branch lengths to scale distances
mpr_costs_bl <- treeseq_linear_mpr(ts, samples, use_brlen=TRUE)

}
\references{
Csűrös, M. (2008) Ancestral Reconstruction by Asymmetric Wagner Parsimony over
Continuous Characters and Squared Parsimony over Distributions. In: Nelson, C.E.,
Vialette, S. (eds) Comparative Genomics. RECOMB-CG 2008. Lecture Notes in
Computer Science, vol 5267. Springer, Berlin, Heidelberg.
}
\seealso{
\code{\link{treeseq_linear_mpr_minimize}} for determining optimal locations
\code{\link{treeseq_discrete_mpr}} for discrete state reconstruction
\code{\link{treeseq_quadratic_mpr}} for squared distance reconstruction
}
